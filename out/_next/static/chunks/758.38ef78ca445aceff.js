"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[758],{77758:(e,a,s)=>{s.r(a),s.d(a,{PaymentFlowCalculator:()=>ex});var t=s(71983),l=s(45849),n=s(95155),r=s(12115),o=s(22544),i=s(66942),d=s(66136),c=s(24580),m=s(71552),u=s(36596),p=s(3998),x=s(86948),h=s(41052),g=s(65142),j=s(76444),b=s(86259),v=s(51834),f=s(6132),y=s(71871),N=s(80647),w=s(24947),C=s(61362),V=s(78519),I=s(91761),S=s(39867),P=s(15530),A=s(23327),k=s(35299),F=s(46826),M=s(89652),D=s(7217),T=s(59427),E=s(45345),R=s(1524),B=s(21786),z=s(78874),O=s(41962),U=s(58341),_=s(70213),L=s(19456),J=s(19056),$=s(90231),q=s(66832),W=s(73254),G=s(87270),H=s(15894),Z=s(24620),Y=s(18332),X=s(92579),Q=s(63004),K=s(58885),ee=s(5958),ea=s(3128),es=s(42943),et=s(67909),el=s(20243);let en=(0,et.default)(()=>Promise.all([s.e(707),s.e(611),s.e(96),s.e(76)]).then(s.bind(s,17189)).then(e=>e.UnitSelectorDialogContent),{loadableGenerated:{webpack:()=>[17189]},loading:()=>(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(el.E,{className:"h-64 w-full"})}),ssr:!1}),er=new Map,eo=d.Ik({type:d.k5(["sinalAto","sinal1","sinal2","sinal3","proSoluto","bonusAdimplencia","desconto","bonusCampanha","fgts","financiamento"]),value:d.au.number().min(0,{message:"O valor deve ser positivo."}),date:d.p6({required_error:"A data \xe9 obrigat\xf3ria."})}),ei=d.Ik({propertyId:d.Yj().min(1,{message:"Selecione um im\xf3vel."}),selectedUnit:d.Yj().optional(),appraisalValue:d.au.number().positive({message:"O valor de avalia\xe7\xe3o \xe9 obrigat\xf3rio."}),saleValue:d.au.number().positive({message:"O valor de venda \xe9 obrigat\xf3rio."}),grossIncome:d.au.number().positive({message:"A renda bruta \xe9 obrigat\xf3ria."}),simulationInstallmentValue:d.au.number().positive({message:"O valor da parcela \xe9 obrigat\xf3rio."}),financingParticipants:d.au.number().int().min(1,"Selecione o n\xfamero de participantes.").max(4),payments:d.YO(eo),conditionType:d.k5(["padrao","especial"]),installments:d.au.number().int().min(1,{message:"M\xednimo de 1 parcela."}).optional(),notaryFees:d.au.number().optional(),notaryPaymentMethod:d.k5(["creditCard","bankSlip"]),notaryInstallments:d.au.number().int().optional()}).refine(e=>"creditCard"!==e.notaryPaymentMethod||!e.notaryInstallments||e.notaryInstallments>=1&&e.notaryInstallments<=12,{message:"Para cart\xe3o de cr\xe9dito, o parcelamento \xe9 de 1 a 12 vezes.",path:["notaryInstallments"]}).refine(e=>"bankSlip"!==e.notaryPaymentMethod||!e.notaryInstallments||[36,40].includes(e.notaryInstallments),{message:"Para boleto, o parcelamento \xe9 de 36 ou 40 vezes.",path:["notaryInstallments"]}),ed=[{value:"sinalAto",label:"Sinal Ato"},{value:"sinal1",label:"Sinal 1"},{value:"sinal2",label:"Sinal 2"},{value:"sinal3",label:"Sinal 3"},{value:"proSoluto",label:"Pr\xf3-Soluto"},{value:"bonusAdimplencia",label:"B\xf4nus Adimpl\xeancia"},{value:"desconto",label:"Desconto"},{value:"bonusCampanha",label:"B\xf4nus de Campanha"},{value:"fgts",label:"FGTS"},{value:"financiamento",label:"Financiamento"}],ec=e=>{switch(e){case"Dispon\xedvel":return"border-primary/50 bg-primary/10 text-primary hover:shadow-lg hover:border-primary";case"Vendido":return"border-destructive/50 bg-destructive/10 text-destructive opacity-60 cursor-not-allowed";case"Reservado":return"border-yellow-500/50 bg-yellow-500/10 text-yellow-600 dark:text-yellow-400 opacity-80 cursor-not-allowed";case"Indispon\xedvel":return"border-muted-foreground/50 bg-muted/80 text-muted-foreground opacity-60 cursor-not-allowed";default:return"border-border bg-muted/80"}},em=(e,a,s,t,l)=>{let n,r=Math.max(a,s),o=e.reduce((e,a)=>e+a.value,0),i=Math.abs(o-r),d=e.find(e=>"desconto"===e.type),c=(null==d?void 0:d.value)||0,m=e.find(e=>"bonusCampanha"===e.type),u=e.find(e=>"sinalAto"===e.type);return m&&u&&t&&u.value<=.055*(s-c)&&(n="B\xf4nus de campanha n\xe3o pode existir quando o sinal ato \xe9 igual ou inferior ao m\xednimo (5%)."),{isValid:i<.01,difference:i,expected:r,actual:o,businessLogicViolation:n}},eu=(e,a,s,t)=>{if(e<=0||a<=0||!s)return{installment:0,total:0};let l=new Date;l.setHours(0,0,0,0);let n=(0,$.w)(s),r=1;t.some(e=>"sinal1"===e.type)&&r++,t.some(e=>"sinal2"===e.type)&&r++,t.some(e=>"sinal3"===e.type)&&r++,s<l&&(r+=(0,U.W)(l,s));let o=0;for(let e=1;e<=a;e++){let a=1;for(let s=1;s<=e;s++){let e=(0,O.P)(l,s);a/=1+((0,$.w)(e)<n?.005:.015)}o+=a}if(0===o)return{installment:0,total:e};let i=e/o;for(let e=0;e<r;e++){let a=(0,O.P)(l,e);i*=1+((0,$.w)(a)<n?.005:.015)}return{installment:i,total:i*a}};(0,r.memo)(e=>{let{unit:a,isReservaParque:s,onUnitSelect:t,style:l}=e,o=(0,r.useMemo)(()=>s?"Torre ".concat(a.block):"Bloco ".concat(a.block),[s,a.block]),i=(0,r.useCallback)(()=>{"Dispon\xedvel"===a.status&&t(a)},[a,t]);return(0,n.jsx)("div",{style:l,children:(0,n.jsxs)(x.Zp,{className:(0,W.cn)("cursor-pointer transition-all duration-200 shadow-sm border rounded-lg overflow-hidden group h-full flex flex-col",ec(a.status),"Dispon\xedvel"===a.status&&"hover:shadow-xl hover:-translate-y-1"),onClick:i,children:[(0,n.jsxs)(x.aR,{className:"p-4 pb-2 flex-row justify-between items-start",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-bold text-base text-card-foreground",children:o}),(0,n.jsxs)("p",{className:"font-semibold text-sm text-primary",children:["Unidade ",a.unitNumber]}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:a.floor})]}),(0,n.jsx)("div",{className:(0,W.cn)("text-xs font-bold px-2 py-1 rounded-full",ec(a.status).replace(/hover:[a-z-]+/g,"")),children:a.status})]}),(0,n.jsxs)(x.Wu,{className:"p-4 pt-2 text-xs space-y-1.5 flex-grow",children:[(0,n.jsxs)("div",{className:"flex justify-between items-baseline pt-2",children:[(0,n.jsx)("span",{className:"font-semibold text-muted-foreground",children:"Venda:"}),(0,n.jsx)("span",{className:"font-bold text-lg text-primary",children:(0,m.pF)(a.saleValue)})]}),(0,n.jsx)(b.w,{className:"my-2"}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(P.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"Tipologia:"})," ",a.typology]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(D.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"\xc1rea:"})," ",a.privateArea.toFixed(2),"m\xb2"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(T.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"Sol:"})," ",a.sunPosition]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(w.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"Vagas:"})," ",a.parkingSpaces]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(E.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"Avalia\xe7\xe3o:"})," ",(0,m.pF)(a.appraisalValue)]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,n.jsx)(E.A,{className:"h-4 w-4 text-primary/70"})," ",(0,n.jsx)("strong",{className:"text-card-foreground/80",children:"B\xf4nus:"})," ",(0,m.pF)(a.complianceBonus)]})]})]})})}).displayName="UnitCard";let ep=(0,r.memo)(e=>{let{name:a,label:s,control:t,readOnly:l=!1,placeholder:r="R$ 0,00",id:o}=e;return(0,n.jsx)(h.zB,{control:t,name:a,render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{id:o,children:[(0,n.jsx)(h.lR,{children:s}),(0,n.jsx)(h.MJ,{children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(I.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,n.jsx)(Q.U,{value:100*a.value,onValueChange:e=>a.onChange(null===e?0:e/100),className:"pl-10",readOnly:l,placeholder:r})]})}),(0,n.jsx)(h.C5,{})]})}})});function ex(e){let{properties:a,isSinalCampaignActive:s,sinalCampaignLimitPercent:d,isTutorialOpen:b,setIsTutorialOpen:w}=e,[D,T]=(0,r.useState)(null),[E,$]=(0,r.useState)(!1),W=(0,r.useRef)(null),et=(0,r.useRef)(null),{toast:el}=(0,H.dj)(),[eo,ec]=(0,r.useState)(!1),[ex,eh]=(0,r.useState)(!1),[eg,ej]=(0,r.useState)(!1),[eb]=(0,r.useState)(""),[ev]=(0,r.useState)(""),[ef,ey]=(0,r.useState)([]),[eN,ew]=(0,r.useState)("Dispon\xedvel"),[eC,eV]=(0,r.useState)("Todos"),[eI,eS]=(0,r.useState)("Todos"),[eP,eA]=(0,r.useState)("Todos"),ek=(0,o.mN)({resolver:(0,i.u)(ei),defaultValues:{propertyId:"",selectedUnit:"",payments:[],appraisalValue:0,saleValue:0,grossIncome:0,simulationInstallmentValue:0,financingParticipants:1,conditionType:"padrao",installments:void 0,notaryFees:void 0,notaryPaymentMethod:"creditCard",notaryInstallments:void 0}}),{fields:eF,append:eM,remove:eD,replace:eT}=(0,o.jz)({control:ek.control,name:"payments"}),eE=ek.watch("payments"),eR=ek.watch("appraisalValue"),eB=ek.watch("saleValue"),ez=ek.watch("propertyId"),eO=ek.watch("financingParticipants"),eU=ek.watch("notaryPaymentMethod"),{setValue:e_,trigger:eL,getValues:eJ}=ek;(0,r.useEffect)(()=>{if(!a.find(e=>e.id===ez))return;let e=(0,Z.M)(eR),s=eO||0;e_("notaryFees",e>0?e+(s>1?(s-1)*110:0):0,{shouldValidate:!0})},[eR,eO,e_,ez,a]),(0,r.useEffect)(()=>{e_("notaryInstallments",void 0,{shouldValidate:!0})},[eU,e_]);let e$=(0,r.useCallback)(e=>{var s;if(!e)return;ek.reset((0,l._)((0,t._)({},ek.getValues()),{propertyId:e,payments:[],appraisalValue:0,saleValue:0,grossIncome:0,simulationInstallmentValue:0,financingParticipants:1,conditionType:"padrao",installments:void 0,notaryPaymentMethod:"creditCard",notaryInstallments:void 0,selectedUnit:""})),T(null),eh(!1),ew("Dispon\xedvel"),eV("Todos"),eS("Todos"),eA("Todos");let n=a.find(a=>a.id===e);if((null==n?void 0:n.availability)&&(null==n||null==(s=n.pricing)?void 0:s.length)){let e=new Map;n.availability.towers.forEach(a=>{a.floors.forEach(s=>{s.units.forEach(t=>{e.set(t.unitId,{status:t.status,floor:s.floor,tower:a.tower})})})}),ey(n.pricing.map(a=>{let s=e.get(a.unitId),n=parseInt(String(a.unitNumber),10).toString();return(0,l._)((0,t._)({},a),{unitNumber:n,status:s?s.status:"Indispon\xedvel",floor:s?s.floor:"N/A",block:s?s.tower:"N/A",sunPosition:a.sunPosition||"N/A",parkingSpaces:a.parkingSpaces||0,typology:a.typology||"N/A",privateArea:a.privateArea||0,appraisalValue:a.appraisalValue||0,saleValue:a.saleValue||0,complianceBonus:a.complianceBonus||0})}))}else ey([])},[a,ek]),eq=(0,r.useCallback)(e=>{ek.setValue("selectedUnit",e.unitNumber,{shouldValidate:!0}),ek.setValue("appraisalValue",e.appraisalValue/100,{shouldValidate:!0}),ek.setValue("saleValue",e.saleValue/100,{shouldValidate:!0}),T(null),eh(!0),ec(!1)},[ek]),eW=(0,r.useMemo)(()=>ef.filter(e=>{let a="Todos"===eN||e.status===eN,s="Todos"===eC||e.floor===eC,t="Todos"===eI||e.typology===eI,l="Todos"===eP||e.sunPosition===eP;return a&&s&&t&&l}),[ef,eN,eC,eI,eP]),eG=(0,r.useCallback)(e=>{var a;let s=null==(a=e.clipboardData)?void 0:a.getData("text");if(s)try{let e=JSON.parse(s);e.grossIncome&&ek.setValue("grossIncome",e.grossIncome),e.simulationInstallmentValue&&ek.setValue("simulationInstallmentValue",e.simulationInstallmentValue),el({title:"Dados colados com sucesso!",description:"Os dados foram extra\xeddos da simula\xe7\xe3o.",variant:"default"})}catch(e){}},[ek,el]),eH=(0,r.useCallback)(async e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(!s)return;if(!(0,es.dn)(s,["application/pdf"]))return void el({title:"Erro de upload",description:"Tipo de arquivo n\xe3o suportado. Use apenas PDF.",variant:"destructive"});if(!(0,es.Gg)(s))return void el({title:"Erro de upload",description:"Arquivo muito grande. Tamanho m\xe1ximo: 5MB.",variant:"destructive"});$(!0);let t=(0,c.Uz)(),l=(0,c.Qg)(t,"extractPricing");try{let e=(await l({file:s})).data;e.grossIncome&&ek.setValue("grossIncome",e.grossIncome),e.simulationInstallmentValue&&ek.setValue("simulationInstallmentValue",e.simulationInstallmentValue),el({title:"Dados extra\xeddos com sucesso!",description:"Os dados foram extra\xeddos do PDF.",variant:"default"})}catch(e){el({title:"Erro ao extrair dados",description:"N\xe3o foi poss\xedvel extrair os dados do PDF. Tente novamente.",variant:"destructive"})}finally{$(!1),W.current&&(W.current.value="")}},[ek,el]),eZ=(0,r.useCallback)(e=>{let a=eF.findIndex(a=>a.type===e);if(a>=0)return void eD(a);let s=new Date,t=s;switch(e){case"sinalAto":default:t=s;break;case"sinal1":t=(0,O.P)(s,1);break;case"sinal2":t=(0,O.P)(s,2);break;case"sinal3":t=(0,O.P)(s,3);break;case"proSoluto":let l=eF.find(e=>"sinal1"===e.type),n=(null==l?void 0:l.date)||s;t=(0,O.P)(n,1)}eM({type:e,value:0,date:t})},[eF,eM,eD]),eY=(0,r.useCallback)(()=>{let e=ek.getValues(),{payments:t,appraisalValue:l,saleValue:n,conditionType:r,grossIncome:o,simulationInstallmentValue:i,installments:c}=e,m=a.find(a=>a.id===e.propertyId),u=(null==m?void 0:m.deliveryDate)?(0,J.H)(m.deliveryDate):null;eT(((e,a,s,t,l,n,r,o,i,d,c)=>{let m=Math.max(a,s),u=[...e],p=u.find(e=>"desconto"===e.type),x=(null==p?void 0:p.value)||0,h=a>s?a-s:0,g=m-u.reduce((e,a)=>["sinalAto","proSoluto","bonusCampanha","desconto"].includes(a.type)?e:e+a.value,0)-h;if(g<=0)return u.filter(e=>!["sinalAto","proSoluto","bonusCampanha"].includes(e.type));let j=s*(r.includes("Reserva Parque Clube")||"especial"===n?.18:.15),b=Math.min(j,((e,a,s,t,l)=>{if(e<=0||a<=0)return 0;let n=0,r=t.reduce((e,a)=>e+a.value,0),o=0;for(let i=0;i<30;i++){let i=(n+r)/2,{installment:d}=l(i,a,s,t);if(d<=e?(o=i,n=i):r=i,r-n<.01)break}return o})(.5*o-i,d,c||new Date,u,eu),g),v=g-(b=Math.max(0,b)),f=0;if(t&&void 0!==l){let e=.055*(s-x);if(v>e){let a=v-e,t=l/100*s;if(a<=t)b-=f=a;else{f=t,v=e+t;let s=b+(a-t);s>j?(b=j,v+=s-j):b=s}}else b=g-(v=e)}let y=u.filter(e=>!["sinalAto","proSoluto","bonusCampanha"].includes(e.type));if(v>0){let e=u.find(e=>"sinalAto"===e.type);y.push({type:"sinalAto",value:v,date:(null==e?void 0:e.date)||new Date})}if(b>0){let e=u.find(e=>"proSoluto"===e.type),a=(null==e?void 0:e.date)||(()=>{let e=u.find(e=>"sinal1"===e.type),a=(null==e?void 0:e.date)||new Date,s=(0,O.P)(a,1);return new Date(s.getFullYear(),s.getMonth(),5)})();y.push({type:"proSoluto",value:b,date:a})}if(f>0){let e=u.find(e=>"bonusCampanha"===e.type);y.push({type:"bonusCampanha",value:f,date:(null==e?void 0:e.date)||new Date})}if(h>0){let e=u.find(e=>"bonusAdimplencia"===e.type);y.push({type:"bonusAdimplencia",value:h,date:(null==e?void 0:e.date)||new Date})}return y})(t,l,n,s,d,r,(null==m?void 0:m.enterpriseName)||"",o,i,c||0,u)),eL("payments")},[ek,a,s,d,eT,eL]),eX=(0,r.useCallback)(async e=>{var t,l,n,r,o,i,c,u;let p=a.find(a=>a.id===e.propertyId);if(!p)return void el({title:"Erro",description:"Im\xf3vel n\xe3o encontrado.",variant:"destructive"});let x=p.deliveryDate?(0,J.H)(p.deliveryDate):null,h=p.constructionStartDate?(0,J.H)(p.constructionStartDate):null,g=em(e.payments,e.appraisalValue,e.saleValue,s,d);if(!g.isValid)return void el({title:"Erro de valida\xe7\xe3o",description:"A soma dos pagamentos (".concat((0,m.pF)(g.actual),") n\xe3o corresponde ao valor de c\xe1lculo (").concat((0,m.pF)(g.expected),"). Diferen\xe7a: ").concat((0,m.pF)(g.difference)),variant:"destructive"});if(g.businessLogicViolation)return void el({title:"Erro de l\xf3gica de neg\xf3cio",description:g.businessLogicViolation,variant:"destructive"});let j=e.notaryFees||(0,Z.M)(e.appraisalValue),b=e.notaryInstallments&&e.notaryInstallments>0&&e.notaryPaymentMethod?(c=e.notaryInstallments,u=e.notaryPaymentMethod,j&&c?"creditCard"===u?j/c:.015*j*Math.pow(1.015,c)/(Math.pow(1.015,c)-1):0):j,v=eu((null==(t=e.payments.find(e=>"proSoluto"===e.type))?void 0:t.value)||0,e.installments||0,x,e.payments),f=v.installment,y=((e,a,s)=>{if(!e||!a||!(0,L.f)(e)||!(0,L.f)(a)||e>a||s<=0)return{total:0,breakdown:[]};let t="".concat(e.getTime(),"-").concat(a.getTime(),"-").concat(s),l=er.get(t);if(l&&Date.now()-l.timestamp<3e5)return{total:l.total,breakdown:l.breakdown};let n=(0,U.W)(a,e);if(n<0)return{total:0,breakdown:[]};let r=0,o=[],i=new Date;for(let a=0;a<=n;a++){let t=(0,O.P)(e,a),l=n>0?a/n:1,d=l*s;t>=i&&(r+=d),o.push({month:(0,_.GP)(t,"MMMM/yyyy",{locale:q.Fo}),value:d,date:t,isPayable:t>=i,progressRate:l})}let d={total:r,breakdown:o,timestamp:Date.now()};return er.set(t,d),d})(h,x,f),N=e.payments.filter(e=>!["proSoluto","financiamento"].includes(e.type)).reduce((e,a)=>e+a.value,0),w=e.payments.filter(e=>"proSoluto"===e.type).reduce((e,a)=>e+a.value,0),C=e.payments.filter(e=>"financiamento"===e.type).reduce((e,a)=>e+a.value,0),V=y.total,I=e.saleValue-((null==(l=e.payments.find(e=>"desconto"===e.type))?void 0:l.value)||0),S=(null==(n=e.payments.find(e=>"proSoluto"===e.type))?void 0:n.value)?e.payments.find(e=>"proSoluto"===e.type).value/I*100:0,P=e.installments&&e.installments>0?(v.total-((null==(r=e.payments.find(e=>"proSoluto"===e.type))?void 0:r.value)||0))/((null==(o=e.payments.find(e=>"proSoluto"===e.type))?void 0:o.value)||1)/e.installments*100:0,A={summary:{remaining:0,okTotal:!0},financedAmount:(null==(i=e.payments.find(e=>"proSoluto"===e.type))?void 0:i.value)||0,steppedInstallments:[f,0,0,0],periodLengths:[e.installments||0,0,0,0],totalWithInterest:v.total,totalConstructionInsurance:y.total,monthlyInsuranceBreakdown:y.breakdown,incomeCommitmentPercentage:f/e.grossIncome*100,proSolutoCommitmentPercentage:S,averageInterestRate:P,notaryInstallmentValue:b,incomeError:void 0,proSolutoError:void 0,paymentValidation:g,totalEntryCost:N,totalProSolutoCost:w,totalFinancedCost:C,totalNotaryCost:j,totalInsuranceCost:V,totalCost:N+w+C+j+V,effectiveSaleValue:I,priceInstallment:f,notaryInstallment:b,constructionInsurance:{breakdown:y.breakdown}};T(A),setTimeout(()=>{var e;null==(e=et.current)||e.scrollIntoView({behavior:"smooth",block:"start"})},100)},[a,s,d,el]),eQ=(0,r.useCallback)(async()=>{if(D){ej(!0);try{let e=eJ(),s=a.find(a=>a.id===e.propertyId),n=(0,l._)((0,t._)({},e),{brokerName:eb,brokerCreci:ev}),r={summary:D.summary,financedAmount:D.financedAmount,steppedInstallments:D.steppedInstallments,periodLengths:D.periodLengths,totalWithInterest:D.totalWithInterest,totalConstructionInsurance:D.totalConstructionInsurance,monthlyInsuranceBreakdown:D.monthlyInsuranceBreakdown,incomeCommitmentPercentage:D.incomeCommitmentPercentage,proSolutoCommitmentPercentage:D.proSolutoCommitmentPercentage,averageInterestRate:D.averageInterestRate,notaryInstallmentValue:D.notaryInstallmentValue,incomeError:D.incomeError,proSolutoError:D.proSolutoError};await (0,K.M)(n,r,s),el({title:"PDF gerado com sucesso!",description:"O arquivo foi baixado para o seu dispositivo.",variant:"default"})}catch(e){el({title:"Erro ao gerar PDF",description:"N\xe3o foi poss\xedvel gerar o PDF. Tente novamente.",variant:"destructive"})}finally{ej(!1)}}},[D,ek,a,ef,eb,ev,el,eJ]),eK=(0,r.useMemo)(()=>D?[{name:"Entrada",label:"Entrada",value:D.totalEntryCost||0,color:"#3b82f6",description:"Pagamentos iniciais (sinais, FGTS, etc.)",fill:"#3b82f6"},{name:"Pr\xf3-Soluto",label:"Pr\xf3-Soluto",value:D.totalProSolutoCost||0,color:"#10b981",description:"Valor financiado pela construtora",fill:"#10b981"},{name:"Financiado",label:"Financiado",value:D.totalFinancedCost||0,color:"#f59e0b",description:"Valor financiado por terceiros",fill:"#f59e0b"},{name:"Cart\xf3rio",label:"Cart\xf3rio",value:D.totalNotaryCost||0,color:"#8b5cf6",description:"Custos com documenta\xe7\xe3o",fill:"#8b5cf6"},{name:"Seguro de Obras",label:"Seguro de Obras",value:D.totalInsuranceCost||0,color:"#ef4444",description:"Seguro obrigat\xf3rio da Caixa",fill:"#ef4444"}].filter(e=>e.value>0):[],[D]),e0=(0,r.useCallback)(e=>e?{summary:e.summary,financedAmount:e.financedAmount,steppedInstallments:e.steppedInstallments,periodLengths:e.periodLengths,totalWithInterest:e.totalWithInterest,totalConstructionInsurance:e.totalConstructionInsurance,monthlyInsuranceBreakdown:e.monthlyInsuranceBreakdown,incomeCommitmentPercentage:e.incomeCommitmentPercentage,proSolutoCommitmentPercentage:e.proSolutoCommitmentPercentage,averageInterestRate:e.averageInterestRate,notaryInstallmentValue:e.notaryInstallmentValue,incomeError:e.incomeError,proSolutoError:e.proSolutoError}:null,[]),e1=(0,r.useMemo)(()=>{var e;let s=ek.watch("propertyId"),t=a.find(e=>e.id===s);return(null==t||null==(e=t.enterpriseName)?void 0:e.includes("Reserva Parque Clube"))||!1},[ek,a]),e2=(0,r.useMemo)(()=>ed.filter(e=>"bonusCampanha"!==e.value||!!s),[s]),e4=(0,r.useMemo)(()=>["Todos",...Array.from(new Set(ef.map(e=>e.floor))).sort((e,a)=>{let s=parseInt(e),t=parseInt(a);return isNaN(s)||isNaN(t)?e.localeCompare(a):t-s})],[ef]),e5=(0,r.useMemo)(()=>["Todos",...Array.from(new Set(ef.map(e=>e.typology))).sort()],[ef]),e6=(0,r.useMemo)(()=>["Todos",...Array.from(new Set(ef.map(e=>e.sunPosition))).sort()],[ef]);return(0,n.jsxs)("div",{className:"w-full max-w-7xl mx-auto p-4 md:p-6 space-y-8 bg-gradient-to-br from-slate-50 to-blue-50/30 min-h-screen",onPaste:eG,children:[(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,n.jsx)(N.A,{className:"h-8 w-8 text-blue-600"}),(0,n.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-slate-800",children:"Calculadora de Condi\xe7\xf5es"})]}),(0,n.jsx)("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Simule condi\xe7\xf5es de pagamento personalizadas para seus clientes"})]}),(0,n.jsxs)(x.Zp,{className:"shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:[(0,n.jsxs)(x.aR,{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg",children:[(0,n.jsxs)(x.ZB,{className:"text-2xl flex items-center gap-2",children:[(0,n.jsx)(y.A,{className:"h-6 w-6"}),"Dados do Im\xf3vel e Cliente"]}),(0,n.jsx)(x.BT,{className:"text-blue-100",children:"Selecione o im\xf3vel e informe os dados b\xe1sicos para a simula\xe7\xe3o"})]}),(0,n.jsx)(x.Wu,{className:"p-6 md:p-8 space-y-8",children:(0,n.jsx)(h.lV,(0,l._)((0,t._)({},ek),{children:(0,n.jsxs)("form",{onSubmit:ek.handleSubmit(eX),className:"space-y-8",children:[(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"propertyId",render:e=>{let{field:s}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Empreendimento *"}),(0,n.jsxs)(u.l6,{onValueChange:e=>{s.onChange(e),e$(e)},value:s.value,children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(u.bq,{className:"bg-white",children:(0,n.jsx)(u.yv,{placeholder:"Selecione um empreendimento"})})}),(0,n.jsx)(u.gC,{children:a.map(e=>(0,n.jsx)(u.eb,{value:e.id,children:e.enterpriseName},e.id))})]}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsx)(h.zB,{control:ek.control,name:"selectedUnit",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Unidade"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(g.p,(0,l._)((0,t._)({},a),{placeholder:"Selecione uma unidade",readOnly:!0,className:"bg-white cursor-pointer",onClick:()=>ec(!0)}))}),(0,n.jsxs)(p.$,{type:"button",variant:"outline",onClick:()=>ec(!0),disabled:!ez,children:[(0,n.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Selecionar"]})]}),(0,n.jsx)(h.C5,{})]})}})]}),ez&&(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-blue-700",children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsxs)("span",{className:"text-sm font-medium",children:[ef.length," unidades encontradas"]})]}),(0,n.jsx)(p.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>ec(!0),className:"text-blue-600 hover:text-blue-800 hover:bg-blue-100",children:"Ver todas as unidades"})]})})]}),(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-slate-700 flex items-center gap-2",children:[(0,n.jsx)(I.A,{className:"h-5 w-5 text-green-600"}),"Valores Fundamentais"]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,n.jsx)(ep,{name:"appraisalValue",label:"Valor de Avalia\xe7\xe3o *",control:ek.control,readOnly:ex,placeholder:"R$ 0,00",id:"appraisal-value-field"}),(0,n.jsx)(ep,{name:"saleValue",label:"Valor de Venda *",control:ek.control,readOnly:ex,placeholder:"R$ 0,00",id:"sale-value-field"}),(0,n.jsx)(ep,{name:"grossIncome",label:"Renda Bruta *",control:ek.control,placeholder:"R$ 0,00",id:"gross-income-field"}),(0,n.jsx)(ep,{name:"simulationInstallmentValue",label:"Valor da Parcela *",control:ek.control,placeholder:"R$ 0,00",id:"simulation-installment-field"})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)(f.A,{className:"h-5 w-5 text-amber-600 mt-0.5 flex-shrink-0"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Dados da Simula\xe7\xe3o da Caixa"}),(0,n.jsx)("p",{className:"text-sm text-amber-700",children:"Cole os dados da simula\xe7\xe3o ou fa\xe7a upload do PDF para preencher automaticamente."})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[(0,n.jsx)("input",{type:"file",ref:W,onChange:eH,accept:".pdf",className:"hidden"}),(0,n.jsxs)(p.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=W.current)?void 0:e.click()},disabled:E,children:[E?(0,n.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,n.jsx)(B.A,{className:"h-4 w-4 mr-2"}),E?"Extraindo...":"Upload PDF"]})]})]})]}),(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-slate-700 flex items-center gap-2",children:[(0,n.jsx)(V.A,{className:"h-5 w-5 text-purple-600"}),"Condi\xe7\xf5es de Pagamento"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"conditionType",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{className:"flex items-center gap-2 space-y-0",children:[(0,n.jsx)(h.lR,{className:"text-sm font-medium",children:"Tipo de Condi\xe7\xe3o:"}),(0,n.jsxs)(u.l6,{onValueChange:a.onChange,value:a.value,children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(u.bq,{className:"w-32 bg-white",children:(0,n.jsx)(u.yv,{})})}),(0,n.jsxs)(u.gC,{children:[(0,n.jsx)(u.eb,{value:"padrao",children:"Padr\xe3o"}),(0,n.jsx)(u.eb,{value:"especial",children:"Especial"})]})]})]})}}),(0,n.jsxs)(p.$,{type:"button",variant:"outline",size:"sm",onClick:eY,className:"flex items-center gap-2",children:[(0,n.jsx)(M.A,{className:"h-4 w-4"}),"Recalcular"]})]})]}),(0,n.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:e2.map(e=>{let a=eF.some(a=>a.type===e.value);return(0,n.jsxs)(p.$,{type:"button",variant:a?"default":"outline",className:"flex items-center gap-2 ".concat(a?"bg-blue-600 hover:bg-blue-700":""),onClick:()=>eZ(e.value),children:[e.label,a?(0,n.jsx)(C.A,{className:"h-4 w-4"}):(0,n.jsx)(F.A,{className:"h-4 w-4"})]},e.value)})}),eF.length>0&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(j.J,{children:"Pagamentos Configurados"}),(0,n.jsx)("div",{className:"space-y-3",children:eF.map((e,a)=>(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start p-4 bg-white border border-slate-200 rounded-lg shadow-sm",children:[(0,n.jsxs)("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"payments.".concat(a,".type"),render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Tipo"}),(0,n.jsxs)(u.l6,{onValueChange:a.onChange,value:a.value,children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(u.bq,{children:(0,n.jsx)(u.yv,{placeholder:"Selecione o tipo"})})}),(0,n.jsx)(u.gC,{children:ed.map(e=>(0,n.jsx)(u.eb,{value:e.value,children:e.label},e.value))})]}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsx)(h.zB,{control:ek.control,name:"payments.".concat(a,".value"),render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Valor"}),(0,n.jsx)(h.MJ,{children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(I.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(Q.U,{value:100*a.value,onValueChange:e=>a.onChange(null===e?0:e/100),className:"pl-9",placeholder:"R$ 0,00"})]})}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsx)(h.zB,{control:ek.control,name:"payments.".concat(a,".date"),render:e=>{let{field:s}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Data"}),(0,n.jsx)(h.MJ,{children:(0,n.jsx)(X.l,{value:s.value?s.value.toISOString().split("T")[0]:"",onChange:e=>s.onChange(e?new Date(e):new Date),disabled:["bonusAdimplencia","financiamento","bonusCampanha"].includes(eF[a].type)})}),(0,n.jsx)(h.C5,{})]})}})]}),(0,n.jsxs)(p.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>eD(a),className:"text-destructive hover:text-destructive/80 hover:bg-destructive/10 mt-2 sm:mt-7",children:[(0,n.jsx)(z.A,{className:"h-4 w-4 mr-1"}),"Remover"]})]},e.id))})]}),eE.length>0&&(0,n.jsx)("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-lg",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(j.J,{className:"text-sm font-medium",children:"Valida\xe7\xe3o da Soma"}),(0,n.jsxs)("p",{className:"text-sm text-slate-600",children:["Soma dos pagamentos: ",(0,n.jsx)("strong",{children:(0,m.pF)(eE.reduce((e,a)=>e+a.value,0))})]}),(0,n.jsxs)("p",{className:"text-sm text-slate-600",children:["Valor de c\xe1lculo: ",(0,n.jsx)("strong",{children:(0,m.pF)(Math.max(eR,eB))})]})]}),(()=>{let e=em(eE,eR,eB,s,d);return(0,n.jsxs)("div",{className:"flex items-center gap-2 ".concat(e.isValid&&!e.businessLogicViolation?"text-green-600":"text-amber-600"),children:[e.isValid&&!e.businessLogicViolation?(0,n.jsx)(C.A,{className:"h-5 w-5"}):(0,n.jsx)(f.A,{className:"h-5 w-5"}),(0,n.jsx)("span",{className:"text-sm font-medium",children:e.isValid&&!e.businessLogicViolation?"V\xe1lido":"Ajuste necess\xe1rio"})]})})()]})})]}),(0,n.jsxs)("section",{className:"space-y-6",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-slate-700 flex items-center gap-2",children:[(0,n.jsx)(R.A,{className:"h-5 w-5 text-orange-600"}),"Parcelamento e Custos Adicionais"]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"installments",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Parcelas do Pr\xf3-Soluto"}),(0,n.jsx)(h.MJ,{children:(0,n.jsx)(g.p,(0,l._)((0,t._)({},a),{type:"number",min:"1",max:"240",placeholder:"Ex: 120",value:a.value||"",onChange:e=>a.onChange(e.target.value?parseInt(e.target.value):void 0)}))}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsx)(h.zB,{control:ek.control,name:"financingParticipants",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Participantes no Financiamento"}),(0,n.jsxs)(u.l6,{onValueChange:e=>a.onChange(parseInt(e)),value:a.value.toString(),children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(u.bq,{className:"bg-white",children:(0,n.jsx)(u.yv,{placeholder:"Selecione o n\xfamero de participantes"})})}),(0,n.jsxs)(u.gC,{children:[(0,n.jsx)(u.eb,{value:"1",children:"1 participante"}),(0,n.jsx)(u.eb,{value:"2",children:"2 participantes"}),(0,n.jsx)(u.eb,{value:"3",children:"3 participantes"}),(0,n.jsx)(u.eb,{value:"4",children:"4 participantes"})]})]}),(0,n.jsx)(h.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"notaryPaymentMethod",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Forma de Pagamento do Cart\xf3rio"}),(0,n.jsxs)(u.l6,{onValueChange:a.onChange,value:a.value,children:[(0,n.jsx)(h.MJ,{children:(0,n.jsx)(u.bq,{className:"bg-white",children:(0,n.jsx)(u.yv,{placeholder:"Selecione a forma de pagamento"})})}),(0,n.jsxs)(u.gC,{children:[(0,n.jsx)(u.eb,{value:"creditCard",children:"Cart\xe3o de Cr\xe9dito"}),(0,n.jsx)(u.eb,{value:"bankSlip",children:"Boleto"})]})]}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(h.zB,{control:ek.control,name:"notaryInstallments",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Parcelas do Cart\xf3rio"}),(0,n.jsx)(h.MJ,{children:(0,n.jsx)(g.p,(0,l._)((0,t._)({},a),{type:"number",min:"1",max:"creditCard"===eU?12:40,placeholder:"creditCard"===eU?"1-12":"36 ou 40",value:a.value||"",onChange:e=>a.onChange(e.target.value?parseInt(e.target.value):void 0)}))}),(0,n.jsx)(h.C5,{})]})}}),(0,n.jsx)(h.zB,{control:ek.control,name:"notaryFees",render:e=>{let{field:a}=e;return(0,n.jsxs)(h.eI,{children:[(0,n.jsx)(h.lR,{children:"Valor do Cart\xf3rio (opcional)"}),(0,n.jsx)(h.MJ,{children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(I.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,n.jsx)(Q.U,{value:100*(a.value||0),onValueChange:e=>a.onChange(null===e?0:e/100),className:"pl-9",placeholder:"Calcular automaticamente"})]})}),(0,n.jsx)(h.C5,{})]})}})]})]})]})]}),(0,n.jsxs)("section",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 pt-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:"Preencha todos os campos obrigat\xf3rios para calcular"})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsxs)(p.$,{type:"button",variant:"outline",onClick:()=>w(!0),className:"flex items-center gap-2",children:[(0,n.jsx)(A.A,{className:"h-4 w-4"}),"Tutorial"]}),(0,n.jsxs)(p.$,{type:"submit",size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2 shadow-lg shadow-blue-600/25",children:[(0,n.jsx)(N.A,{className:"h-5 w-5"}),"Calcular Condi\xe7\xe3o"]})]})]})]})}))})]}),D&&(0,n.jsx)("div",{ref:et,children:(0,n.jsxs)(x.Zp,{className:"shadow-xl border-0 bg-gradient-to-br from-green-50 to-emerald-100/50 backdrop-blur-sm",children:[(0,n.jsxs)(x.aR,{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-t-lg",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(x.ZB,{className:"text-2xl flex items-center gap-2",children:[(0,n.jsx)(C.A,{className:"h-6 w-6"}),"Resultado da Simula\xe7\xe3o"]}),(0,n.jsxs)(p.$,{onClick:eQ,disabled:eg,variant:"secondary",size:"sm",className:"bg-white/20 hover:bg-white/30 text-white border-white/30",children:[eg?(0,n.jsx)(k.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,n.jsx)(S.A,{className:"h-4 w-4 mr-2"}),eg?"Gerando...":"Baixar PDF"]})]}),(0,n.jsx)(x.BT,{className:"text-green-100",children:"Confira os detalhes da condi\xe7\xe3o calculada"})]}),(0,n.jsxs)(x.Wu,{className:"p-6 md:p-8 space-y-8",children:[eK.length>0&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-lg font-semibold text-slate-700",children:"Distribui\xe7\xe3o dos Custos"}),(0,n.jsx)(ea.m,{data:eK,value:D.totalCost||0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("h5",{className:"font-semibold text-slate-700",children:"Custos Principais"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Entrada"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.totalEntryCost||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Pr\xf3-Soluto"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.totalProSolutoCost||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Financiado"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.totalFinancedCost||0)})]})]})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("h5",{className:"font-semibold text-slate-700",children:"Custos Adicionais"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Cart\xf3rio"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.totalNotaryCost||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Seguro de Obras"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.totalInsuranceCost||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 bg-green-50 rounded px-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-green-700",children:"Custo Total"}),(0,n.jsx)("span",{className:"font-bold text-green-700",children:(0,m.pF)(D.totalCost||0)})]})]})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("h5",{className:"font-semibold text-slate-700",children:"Parcelas"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Pr\xf3-Soluto"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.priceInstallment||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[(0,n.jsx)("span",{className:"text-sm text-slate-600",children:"Cart\xf3rio"}),(0,n.jsx)("span",{className:"font-semibold text-slate-800",children:(0,m.pF)(D.notaryInstallment||0)})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-200 bg-blue-50 rounded px-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Valor Efetivo de Venda"}),(0,n.jsx)("span",{className:"font-bold text-blue-700",children:(0,m.pF)(D.effectiveSaleValue||0)})]})]})]})]}),D.constructionInsurance&&D.constructionInsurance.breakdown.length>0&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-lg font-semibold text-slate-700",children:"Detalhamento do Seguro de Obras"}),(0,n.jsx)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:(0,n.jsxs)(G.XI,{children:[(0,n.jsx)(G.A0,{children:(0,n.jsxs)(G.Hj,{children:[(0,n.jsx)(G.nd,{children:"M\xeas"}),(0,n.jsx)(G.nd,{children:"Taxa de Andamento"}),(0,n.jsx)(G.nd,{className:"text-right",children:"Valor do Seguro"}),(0,n.jsx)(G.nd,{className:"text-right",children:"Status"})]})}),(0,n.jsx)(G.BF,{children:D.constructionInsurance.breakdown.map((e,a)=>(0,n.jsxs)(G.Hj,{children:[(0,n.jsx)(G.nA,{className:"font-medium",children:e.month}),(0,n.jsx)(G.nA,{children:(0,m.Ee)(e.progressRate)}),(0,n.jsx)(G.nA,{className:"text-right",children:(0,m.pF)(e.value)}),(0,n.jsx)(G.nA,{className:"text-right",children:(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.isPayable?"bg-green-100 text-green-800":"bg-slate-100 text-slate-800"),children:e.isPayable?"A pagar":"Pago"})})]},a))})]})})]}),D.paymentValidation&&(0,n.jsxs)(Y.Fc,{className:D.paymentValidation.isValid&&!D.paymentValidation.businessLogicViolation?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200",children:[(0,n.jsx)(C.A,{className:"h-4 w-4 ".concat(D.paymentValidation.isValid&&!D.paymentValidation.businessLogicViolation?"text-green-600":"text-amber-600")}),(0,n.jsx)(Y.XL,{children:D.paymentValidation.isValid&&!D.paymentValidation.businessLogicViolation?"Condi\xe7\xe3o v\xe1lida":"Ajustes necess\xe1rios"}),(0,n.jsx)(Y.TN,{children:D.paymentValidation.isValid&&!D.paymentValidation.businessLogicViolation?"A soma dos pagamentos corresponde ao valor de c\xe1lculo e atende todas as regras de neg\xf3cio.":D.paymentValidation.businessLogicViolation?D.paymentValidation.businessLogicViolation:"A soma dos pagamentos (".concat((0,m.pF)(D.paymentValidation.actual),") difere do valor de c\xe1lculo (").concat((0,m.pF)(D.paymentValidation.expected),") em ").concat((0,m.pF)(D.paymentValidation.difference),".")})]})]})]})}),(0,n.jsx)(v.lG,{open:eo,onOpenChange:ec,children:(0,n.jsxs)(v.Cf,{className:"max-w-7xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,n.jsxs)(v.c7,{children:[(0,n.jsx)(v.L3,{children:"Selecionar Unidade"}),(0,n.jsx)(v.rr,{children:"Escolha uma unidade dispon\xedvel para preencher automaticamente os valores."})]}),(0,n.jsx)(en,{allUnits:ef,filteredUnits:eW,isReservaParque:e1,onUnitSelect:eq,filters:{status:eN,setStatus:ew,floor:eC,setFloor:eV,typology:eI,setTypology:eS,sunPosition:eP,setSunPosition:eA},filterOptions:{floors:e4,typologies:e5,sunPositions:e6}})]})}),(0,n.jsx)(ee.InteractiveTutorial,{isOpen:b,onClose:()=>w(!1),form:ek,results:e0(D)})]})}ep.displayName="CurrencyFormField"}}]);