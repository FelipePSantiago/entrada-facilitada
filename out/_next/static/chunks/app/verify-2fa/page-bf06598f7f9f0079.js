(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{2809:(e,a,s)=>{Promise.resolve().then(s.bind(s,8855))},8855:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>g});var t=s(95155),i=s(12115),r=s(67909),l=s(20063),c=s(3998),n=s(86948),o=s(65142),d=s(76444),m=s(15894),u=s(37880),x=s(65380),h=s(24580),f=s(18874),p=s(86512);function j(){let e=(0,l.useRouter)(),{toast:a}=(0,m.dj)(),{user:s,authLoading:r,setIsFullyAuthenticated:j,isFullyAuthenticated:v,functions:g}=(0,x.A)(),[N,w]=(0,i.useState)(""),[y,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{r||s||e.replace("/login")},[r,s,e]);let b=async t=>{if(t.preventDefault(),!s||!g)return void a({variant:"destructive",title:"Erro",description:"Usu\xe1rio n\xe3o encontrado."});k(!0);try{let t=(0,h.Qg)(g,"verifyTokenAction");if((await t({token:N})).data)a({title:"Verifica\xe7\xe3o bem-sucedida!",description:"Voc\xea est\xe1 autenticado."}),localStorage.setItem("2fa-verified-".concat(s.uid),"true"),j(!0),e.push("/simulator");else throw Error("C\xf3digo inv\xe1lido. Tente novamente.")}catch(e){a({variant:"destructive",title:"Erro na Verifica\xe7\xe3o",description:e.message||"N\xe3o foi poss\xedvel verificar o c\xf3digo."})}finally{k(!1)}},E=async()=>{try{await (0,f.CI)(p.j)}catch(e){a({variant:"destructive",title:"Erro ao Sair",description:"Ocorreu um erro ao tentar voltar para a tela de login."})}};return r||s&&v?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-10rem)]",children:[(0,t.jsx)(u.k,{className:"h-12 w-12 animate-spin text-primary"}),(0,t.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Redirecionando..."})]}):(0,t.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,t.jsxs)(n.Zp,{className:"w-full max-w-sm",children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{className:"text-2xl",children:"Verifica\xe7\xe3o 2FA"}),(0,t.jsx)(n.BT,{children:"Digite o c\xf3digo do seu aplicativo de autentica\xe7\xe3o para continuar."})]}),(0,t.jsxs)("form",{onSubmit:b,children:[(0,t.jsxs)(n.Wu,{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"token",children:"C\xf3digo de 6 d\xedgitos"}),(0,t.jsx)(o.p,{id:"token",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,required:!0,value:N,onChange:e=>w(e.target.value)})]}),(0,t.jsx)("div",{className:"text-center text-sm",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Problemas com o c\xf3digo? Fale com o suporte."})})]}),(0,t.jsxs)(n.wL,{className:"flex flex-col gap-4",children:[(0,t.jsxs)(c.$,{type:"submit",className:"w-full",disabled:y||6!==N.length,children:[y&&(0,t.jsx)(u.k,{className:"mr-2 h-4 w-4 animate-spin"}),"Verificar"]}),(0,t.jsxs)(c.$,{variant:"outline",className:"w-full",type:"button",onClick:E,children:[(0,t.jsx)(u.n,{className:"mr-2 h-4 w-4"}),"Voltar para o Login"]})]})]})]})})}let v=(0,r.default)(()=>Promise.resolve(j),{loading:()=>(0,t.jsx)("div",{className:"w-full max-w-sm",children:(0,t.jsx)(n.Zp,{children:(0,t.jsx)(n.aR,{children:(0,t.jsx)(u.k,{className:"h-8 w-8 animate-spin"})})})}),ssr:!1});function g(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-10rem)]",children:(0,t.jsx)(u.k,{className:"h-12 w-12 animate-spin text-primary"})}),children:(0,t.jsx)(v,{})})}}},e=>{e.O(0,[58,327,707,611,96,76,358],()=>e(e.s=2809)),_N_E=e.O()}]);